var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var c=0;return function(){return c<b.length?{done:!1,value:b[c++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,f){b!=Array.prototype&&b!=Object.prototype&&(b[c]=f.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(b,c){this.$jscomp$symbol$id_=b;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(f||"")+"_"+c++,f)}var c=0;return b}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.asyncIterator;b||(b=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};
$jscomp.iteratorFromArray=function(b,c){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var f=0,e={next:function(){if(f<b.length){var g=f++;return{value:c(g,b[g]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill=function(b,c,f,e){if(c){f=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var g=b[e];g in f||(f[g]={});f=f[g]}b=b[b.length-1];e=f[b];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(f,b,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
(function(b){var c="";require.s.contexts.hasOwnProperty("_")&&(c=require.s.contexts._.config.paths.JsMVA.replace("src/js/JsMVA.min",""));define(["d3"],function(f){return b({},f,c)})})(function(b,c,f){Object.size=function(a){return Object.keys(a).length};var e=150,g=40,r={"default":"#CCC",focus:"#033A00"},B=f+"img/reset.png",m=c.scale.linear().range(["red","blue"]),h,k,p,t,q=c.layout.tree(),u=function(){var a=c.svg.diagonal();return function(b,d,n){return n?a(b):a({source:{x:b.source.x+e,y:b.source.y},
target:{x:b.target.x+e,y:b.target.y-g}})}}(),D=function(a){"children"in a?(a._children=a.children,a.children=null):(a.children=a._children,a._children=null);v(a)},E=function(a){var b=g;a.append("text").attr("dy",.35*b).attr("class","label1").attr("dx","4px").style("fill-opacity",1E-6).style("font-size","0.000001px").style("cursor","pointer").style("fill","#DEDEDE").style("font-weight","bold").text(function(a){return"S/(S+B)="+Number(a.info.purity).toFixed(3)});a.append("text").attr("class","label2").attr("dx",
"4px").attr("dy",.75*b).style("fill-opacity",1E-6).style("cursor","pointer").text(function(a){return-1!=a.info.IVar?t[a.info.IVar]+">"+Number(a.info.Cut).toFixed(3):""}).style("font-size","0.000001px").style("fill","#DEDEDE").style("font-weight","bold")},F=function(a,b){var d=a.enter().append("g").attr("class","nodes").attr("transform",function(a){return"translate("+b.x0+","+b.y0+")"}).style("cursor","pointer");d.filter(function(a){return a.parent}).on("click",D).on("mouseover",w).on("contextmenu",
function(a,d){c.event.preventDefault();x(a)}).on("mouseleave",function(a,d){a.bigger&&x(a,d,1);return w(a,d,1)});d.append("rect").attr("width",1E-6).attr("height",1E-6);E(d);a.transition().duration(1500).attr("transform",function(a){return"translate("+(a.x+.5*e)+","+(a.y-g)+")"});a.select("rect").transition().duration(1500).attr("width",e).attr("height",g).attr("fill",function(a){return m(Number(a.info.purity))}).style("stroke-width","4px").style("stroke",function(a){return a._children?"#00A62B":
""});a.selectAll("text").transition().duration(1500).style("font-size",function(a){var d="S/(S+B)="+Number(a.info.purity).toFixed(3),b=-1!=a.info.IVar?t[a.info.IVar]+">"+Number(a.info.Cut).toFixed(3):"";a.font_size=1.5*(e-2*Number("4px".replace("px","")))/Math.max(d.length,b.length);return a.font_size+"px"}).attr("dx","4px").attr("dy",function(a){return("label1"==c.select(this).attr("class")?.35*g:.75*g)+"px"}).style("fill-opacity",1);a=a.exit().transition().duration(1500).attr("transform",function(a){return"translate("+
(b.x+e)+","+b.y+")"}).remove();a.select("rect").attr("width",1E-6).attr("height",1E-6);a.selectAll("text").style("font-size","0.000001px").style("fill-opacity",1E-6)},G=function(a,b){a.enter().insert("path","g").attr("class","link").attr("d",function(a,n){a={x:b.x0,y:b.y0};return u({source:a,target:a},n,1)});a.transition().duration(1500).attr("d",u).style("fill","none").style("stroke",r["default"]).style("stroke-width","4px").attr("id",function(a){return"link"+a.target.id});a.exit().transition().duration(1500).attr("d",
function(a,n){a={x:b.x+e,y:b.y};return u({source:a,target:a},n,1)}).remove()},w=function(a,b,d){k.selectAll("path.link").filter(function(b){return b.target.id==a.id}).style("stroke-width",d?"4px":"8px").style("stroke",d?r["default"]:r.focus);k.selectAll("g.nodes rect").filter(function(b){return b.id==a.id}).style("stroke-width","4px").style("stroke",function(a){return d?a._children?"#00A62B":m(a.info.purity):"#033A00"});a.parent&&w(a.parent,b,d)},x=function(a,b,d){var n=d?e:2*e,l=d?g:1.5*g;console.log("anim height:"+
String(l));k.selectAll("g.nodes rect").filter(function(b){b.bigger=d?!1:!0;return b.id==a.id}).transition().duration(750).attr("width",n+"px").attr("height",l+"px");k.selectAll("g.nodes text").filter(function(b){return b.id==a.id}).transition().duration(750).style("font-size",function(a){return(d?a.font_size:2*a.font_size)+"px"}).attr("dx",d?"4px":2*Number("4px".replace("px",""))+"px").attr("dy",function(){return("label1"==c.select(this).attr("class")?.35*l:.75*l)+"px"});a.parent&&x(a.parent,b,d)},
v=function(a,b){z();var d=q.nodes(p),c=q.links(d),l=0;d.forEach(function(a){l<Number(a.depth)&&(l=Number(a.depth))});d.forEach(function(a){a.y=a.depth*h.height/l});"x0"in a&&"y0"in a||(a.x0=d[0].x+.5*e,a.y0=d[0].y-g);var C=k.selectAll("g.nodes").data(d,function(a,b){return a.id||(a.id=b)});F(C,a);c=k.selectAll("path.link").data(c,function(a){return a.target.id});G(c,a);k.transition().duration(1500).attr("transform","translate("+-e+", "+g+")");void 0!==b&&1==b||d.forEach(function(a){a.x0=a.x+e;a.y0=
a.y})},y=function(a){if(void 0!==a.length){var b=0,d;for(d in a)b+=y(a[d]);return b}return"children"in a&&0!=a.children.length?1+y(a.children):0},H=function(a){var b=1E6,d=-1E6,c;for(c in a){var e=Number(a[c].info.purity);e<b&&(b=e);e>d&&(d=e)}return[b,d]},z=function(a){a=q.nodes(p);for(d in a)if(!a[d].parent){var b=a[d];break}var d=y(b);g=h.height/(d+1)-40;60<g&&(g=60);for(b=0;0!=d;)d%4||b++,d/=4;d=h.width;var c=[],l;for(l in a)-1==c.indexOf(Math.round(a[l].x))&&c.push(Math.round(a[l].x));e=d/(c.length+
1+1-b)-20;150<e&&(g=150);q.size([h.width,h.height]);m.domain(H(a))},I=function(a){var b=[{text:"Pure Backg.",id:"label1",color:m(m.domain()[0]),x:5,y:5},{text:"Pure Signal",id:"label2",color:m(m.domain()[1]),x:5,y:40}];a=a.append("g").attr("transform","translate(5,5)").selectAll("g").data(b,function(a){return a.id}).enter().append("g").style("cursor","pointer").attr("transform",function(a){return"translate("+a.x+","+a.y+")"});a.on("mouseover",function(a){c.select("#"+a.id).style("font-weight","bold");
c.select("#"+a.id+"_rect").attr("width",115)});a.on("mouseout",function(a){c.select("#"+a.id).style("font-weight","normal");c.select("#"+a.id+"_rect").attr("width",100)});a.append("rect").attr("id",function(a){return a.id+"_rect"}).attr("width",100).attr("height",30).attr("fill",function(a){return a.color});a.append("text").attr("id",function(a){return a.id}).attr("x",function(a){return 5}).attr("y",function(a){return 20}).text(function(a){return a.text}).style("fill","#DEDEDE")},A=function(a){"_children"in
a&&null==a.children&&(a.children=a._children,a._children=null);if("children"in a&&null!=a.children)for(var b in a.children)A(a.children[b])};b.draw=function(a,b){a=c.select("#"+a);p=b.tree;t=b.variables;if(0==Object.size(p))a.innerHTML="<b style='color:red'>Tree empty...</b>";else{h={width:a.property("style").width,height:a.property("style").height};b=k=a.append("svg").attr("width",h.width).attr("height",h.height);Object.keys(h).forEach(function(a){h[a]=Number(h[a].replace("px",""));h[a]-="width"==
a?40+e:40+g});z(1);var d=c.behavior.zoom().scaleExtent([1,10]).on("zoom",function(){k.attr("transform","translate("+-e+", "+g+")translate("+c.event.translate+")scale("+c.event.scale+")")});k=k.on("dblclick",function(){d.scale(1);d.translate([0,0]);k.transition().attr("transform","translate("+-e+", "+g+")")}).append("g").call(d).append("g").attr("transform","translate("+-e+", "+g+")");I(b);v(p);a.append("button").style("position","relative").style("top","-36px").style("width","36px").style("height",
"36px").style("opacity","0.5").style("background","white").style("background-size","contain").style("background-image","url("+B+")").style("cursor","pointer").style("border","none").on("mouseover",function(){c.select(this).style("opacity","1")}).on("mouseout",function(){c.select(this).style("opacity","0.5")}).on("click",function(){d.scale(1);d.translate([0,0]);k.transition().attr("transform","translate("+-e+", "+g+")");var a=p;var b=[],c=[];for(c.push(a);0<c.length;){var f=c.shift();"_children"in
f&&null!=f._children&&b.push(f);if(null!=f.children)for(var h=0;h<f.children.length;h++)c.push(f.children[h])}a=0<b.length?b:a;for(b=0;b<a.length;b++)A(a[b]),v(a[b],!0)})}};Object.seal(b);return b});
